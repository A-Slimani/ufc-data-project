SELECT
    f.id,
    f.event_id,
    f.r_fighter_id,
    rf.full_name AS r_fighter_name,
    f.r_fighter_status,
    f.b_fighter_id,
    bf.full_name AS b_fighter_name, 
    f.b_fighter_status,
    f.fight_order,
    f.round,
    f.time,
    f.method,
    f.method_type,
    f.bout_weight,
    f.url,
    f.fight_date,
    f.last_updated_at,
    f.clinch_time,
    (EXTRACT(EPOCH FROM ('00:' || f.clinch_time)::INTERVAL)::INT) AS "clinch_time_seconds",
    f.ground_time,
    (EXTRACT(EPOCH FROM ('00:' || f.ground_time)::INTERVAL)::INT) AS "ground_time_seconds",
    f.standing_time,
    (EXTRACT(EPOCH FROM ('00:' || f.standing_time)::INTERVAL)::INT) AS "standing_time_seconds",
    f.r_knockdowns,
    f.b_knockdowns,
    f.r_takedowns_attempted,
    f.b_takedowns_attempted,
    f.r_takedowns_landed,
    f.b_takedowns_landed,
    f.r_sig_strikes_attempted,
    f.b_sig_strikes_attempted,
    f.r_sig_strikes_landed,
    f.b_sig_strikes_landed,
    f.r_sig_strikes_accuracy,
    f.b_sig_strikes_accuracy,
    f.r_total_strikes_attempted,
    f.b_total_strikes_attempted,
    f.r_total_strikes_landed,
    f.b_total_strikes_landed,
    f.r_submissions_attempted,
    f.b_submissions_attempted,
    f.r_total_control_time,
    (EXTRACT(EPOCH FROM ('00:' || f.r_total_control_time)::INTERVAL)::INT) AS "r_total_control_time_seconds",
    f.b_total_control_time,
    (EXTRACT(EPOCH FROM ('00:' || f.b_total_control_time)::INTERVAL)::INT) AS "b_total_control_time_seconds",
    f.r_clinch_control_time,
    (EXTRACT(EPOCH FROM ('00:' || f.r_clinch_control_time)::INTERVAL)::INT) AS "r_clinch_control_time_seconds",
    f.b_clinch_control_time,
    (EXTRACT(EPOCH FROM ('00:' || f.b_clinch_control_time)::INTERVAL)::INT) AS "b_clinch_control_time_seconds",
    f.r_ground_control_time,
    (EXTRACT(EPOCH FROM ('00:' || f.r_ground_control_time)::INTERVAL)::INT) AS "r_ground_control_time_seconds",
    f.b_ground_control_time,
    (EXTRACT(EPOCH FROM ('00:' || f.b_ground_control_time)::INTERVAL)::INT) AS "b_ground_control_time_seconds"
FROM {{ ref('stg_fights') }} f
JOIN {{ ref('stg_events') }} e ON f.event_id = e.id
JOIN {{ ref('stg_fighters') }} rf ON f.r_fighter_id = rf.id
JOIN {{ ref('stg_fighters') }} bf ON f.b_fighter_id = bf.id